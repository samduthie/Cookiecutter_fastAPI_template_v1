name: Cookiecutter Verification Smoke Test

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  smoke-test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Template
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"

      - name: Install Cookiecutter
        run: pip install cookiecutter

      - name: Bake Project
        # This creates a folder named 'my_fastapi_app' inside /tmp
        run: cookiecutter . --no-input -o /tmp/

      - name: Verify Boilerplate
        # We enter the generated folder and run our checks
        run: |
          cd /tmp/fastapi_scaffold
          
          # 1. Check if essential files exist
          # test -f main.py || exit 1
          # test -f Makefile || exit 1
          
          # # 2. Try to run the Makefile commands (assuming they exist in your template)
          # # We use --version or help checks to avoid starting a long-running server
          # make --version
        